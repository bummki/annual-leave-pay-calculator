<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>연차 휴가계산기 · Toss/Finda 스타일 (2017.05.30 이후 기준)</title>
  <meta name="description" content="입사일과 계산일(또는 퇴직일)을 넣으면 1년 미만 월 단위 휴가(최대 11일) + 2년차 이후 연차(가산 포함)를 간이 계산합니다. 2017‑05‑30 이후 입사자 기준 베타." />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{ --primary:#3182F6; --primary-dark:#1B64DA; --ink:#0F172A; --sub:#334155; --muted:#64748B; --line:#E2E8F0; --bg:#F8FAFC; }
    html,body{ height:100%; }
    body{ background:var(--bg); color:var(--ink); font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","SF Pro Display","Noto Sans KR",system-ui,Segoe UI,Roboto,Helvetica,Arial; }
    .balance{ text-wrap:balance; }
    .container{ max-width: 1120px; }
    .card{ background:#fff; border:1px solid var(--line); border-radius:16px; box-shadow:0 1px 2px rgba(16,24,40,.05); }
    .card:hover{ box-shadow:0 2px 8px rgba(16,24,40,.08); }
    .btn{ display:inline-flex; align-items:center; justify-content:center; gap:.5rem; font-weight:600; border-radius:12px; padding:.875rem 1.25rem; transition:all .15s ease; }
    .btn-primary{ background:var(--primary); color:#fff; }
    .btn-primary:hover{ background:var(--primary-dark); }
    .btn-secondary{ background:#F1F5F9; color:var(--ink); border:1px solid var(--line); }
    .btn-secondary:hover{ background:#E2E8F0; }
    .input{ background:#fff; border:1px solid #CBD5E1; border-radius:12px; padding:.75rem 1rem; width:100%; }
    .input:focus{ outline: none; box-shadow: 0 0 0 2px rgba(49,130,246,.35); border-color:#93C5FD; }
    .chip{ background:#EEF2FF; color:#3730A3; border:1px solid #E0E7FF; font-size:.75rem; padding:.25rem .5rem; border-radius:999px; }
    ::-webkit-scrollbar{ height:10px; width:10px }
    ::-webkit-scrollbar-track{ background:transparent }
    ::-webkit-scrollbar-thumb{ background:#CBD5E1; border-radius:8px }
  /* Removed Glass theme */
    .white-gradient-text{color:inherit;background:none;-webkit-background-clip:initial;background-clip:initial}
    .txt-glow{ text-shadow:none }
  </style>
</head>
<body class="min-h-screen">
  <!-- Header -->
  <header class="sticky top-0 z-30 bg-white border-b border-slate-200">
    <div class="mx-auto container px-5 py-3 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="h-9 w-9 grid place-items-center rounded-xl border border-slate-200 bg-white">
          <!-- calendar icon -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-slate-700" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2Z"/></svg>
        </div>
        <div class="font-semibold">연차 휴가계산기 <span class="text-slate-400">· Beta</span></div>
      </div>
      <nav class="hidden md:flex items-center gap-4 text-sm text-slate-600">
        <a href="#calc" class="hover:text-slate-900">Calculator</a>
        <a href="#faq" class="hover:text-slate-900">FAQ</a>
        
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="mx-auto container px-5 py-10 md:py-16">
    <div class="grid lg:grid-cols-2 gap-10 items-center">
      <div>
        <h1 class="balance tracking-tight font-extrabold text-4xl md:text-5xl lg:text-7xl text-slate-900">읽기 쉬운 연차 휴가계산기</h1>
        <p class="mt-4 text-lg text-slate-700 leading-8">입사일과 계산일(또는 퇴직일)을 입력하면 <strong>1년 미만 월 단위 휴가(최대 11일)</strong>와 <strong>2년차 이후 연차(가산 포함)</strong>를 간이 산정합니다. <span class="chip">2017‑05‑30 이후 입사자 기준</span></p>
        <div class="mt-6 flex flex-wrap gap-3">
          <a href="#calc" class="btn btn-primary">지금 계산하기
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="m14 5 7 7-7 7M21 12H3"/></svg>
          </a>
          <button id="btn-open-guide" class="btn btn-secondary">가이드 보기</button>
        </div>
        <p class="mt-3 text-sm text-slate-500">* 출근율/휴직/단시간근로 등 특례는 미반영된 <b>간이 모델</b>입니다.</p>
      </div>
      <div class="card p-6 md:p-7">
        <h3 class="text-slate-900 font-semibold">오늘 기준 예시</h3>
        <div class="mt-4 grid grid-cols-2 gap-4">
          <div class="card p-4">
            <div class="text-xs text-slate-500">입사일</div>
            <div class="text-lg">2024‑08‑29</div>
          </div>
          <div class="card p-4">
            <div class="text-xs text-slate-500">계산일</div>
            <div class="text-lg" id="demo-today">2025‑08‑29</div>
          </div>
          <div class="col-span-2 card p-4">
            <div class="text-xs text-slate-500">예상 총 연차</div>
            <div class="text-3xl font-extrabold text-slate-900">≈ 11일</div>
            <p class="text-sm text-slate-600 mt-1">1년 미만 월차 11일 + 2년차 시작일 당일 퇴직 가정 → 0일</p>
          </div>
        </div>
        <button id="btn-fill-demo" class="mt-5 w-full btn btn-secondary">예시값으로 입력 채우기</button>
      </div>
    </div>
  </section>

  <!-- Calculator -->
  <section id="calc" class="mx-auto container px-5 pb-24">
    <div class="card p-6 md:p-8">
      <div class="flex flex-wrap items-start gap-6 justify-between">
        <div>
          <h2 class="balance text-2xl md:text-4xl font-extrabold">입력</h2>
          <p class="mt-2 text-slate-600">입사일과 계산일(퇴직일)을 넣고 <b>계산</b>을 눌러주세요.</p>
        </div>
        <div class="text-sm text-slate-500">기준: <span class="font-medium text-slate-800">입사일 기준</span> / <span class="text-slate-400">회계연도(1/1) 기준은 차기 업데이트</span></div>
      </div>

      <div class="mt-6 grid md:grid-cols-3 gap-5">
        <label class="block">
          <span class="text-sm text-slate-600">입사일 (Start date)</span>
          <input id="start" type="date" class="input mt-2" />
        </label>
        <label class="block">
          <div class="flex items-center justify-between">
            <span class="text-sm text-slate-600">계산일 / 퇴직일 (Calc / Separation)</span>
            <label class="text-xs flex items-center gap-2 select-none"><input id="still-employed" type="checkbox" class="accent-[--primary]"> 재직 중</label>
          </div>
          <input id="end" type="date" class="input mt-2" />
          <div class="mt-2 flex flex-wrap gap-4 text-sm text-slate-600">
            <label class="inline-flex items-center gap-2"><input type="radio" name="date-mode" value="asof" class="accent-[--primary]" checked> 계산일=오늘/마지막 근무일</label>
            <label class="inline-flex items-center gap-2"><input type="radio" name="date-mode" value="retirement" class="accent-[--primary]"> 퇴직일=마지막 근무일 다음날</label>
          </div>
          <p class="mt-1 text-xs text-slate-500">* 퇴직일은 <b>마지막 근무일 다음날</b>을 의미합니다.</p>
        </label>
        <label class="block">
          <span class="text-sm text-slate-600">법령 모드 (Legal mode)</span>
          <select id="law-mode" class="input mt-2">
            <option value="post20170530">2017‑05‑30 이후 입사자 (현행)</option>
            <option value="pre20170530">2017‑05‑29 이전 입사자 (간이)</option>
          </select>
          <p class="mt-1 text-xs text-slate-500">간이 모드에는 일부 가정이 포함됩니다.</p>
        </label>
      </div>

      <div class="mt-6 flex flex-wrap gap-3">
        <button id="btn-calc" class="btn btn-primary">계산 (Calculate)
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 4v16m8-8H4"/></svg>
        </button>
        <button id="btn-reset" class="btn btn-secondary">초기화 (Reset)</button>
        <button id="btn-print" class="btn btn-secondary">인쇄 (Print)</button>
      </div>

      <!-- 결과 -->
      <div id="result" class="mt-10 hidden">
        <div class="flex flex-wrap items-center justify-between gap-4">
          <h3 class="text-xl md:text-2xl font-extrabold">결과</h3>
          <div class="flex items-center gap-2">
            <button id="btn-copy" class="btn btn-secondary">결과 복사</button>
            <button id="btn-csv" class="btn btn-secondary">CSV 다운로드</button>
          </div>
        </div>

        <div class="mt-5 grid gap-5 lg:grid-cols-3">
          <div class="card p-5">
            <div class="text-sm text-slate-600">총 연차 합계 (Total)</div>
            <div id="total-days" class="mt-2 text-4xl font-extrabold">0일</div>
            <div id="total-note" class="text-xs text-slate-500 mt-1"></div>
          </div>
          <div class="card p-5">
            <div class="text-sm text-slate-600">1년 미만 월 단위 (Up to 11d)</div>
            <div id="first-year-days" class="mt-2 text-3xl font-bold">0일</div>
            <div class="text-xs text-slate-500 mt-1">매 1개월 경과 시 1일 부여 (최대 11일)</div>
          </div>
          <div class="card p-5">
            <div class="text-sm text-slate-600">연차 (연차가산 포함)</div>
            <div id="annual-days" class="mt-2 text-3xl font-bold">0일</div>
            <div class="text-xs text-slate-500 mt-1">2년차부터 15일, 이후 2년마다 1일 가산(최대 25일)</div>
          </div>
        </div>

        <div class="mt-8 overflow-hidden rounded-2xl border border-slate-200">
          <table class="w-full text-sm">
            <thead class="bg-slate-100 text-slate-700">
              <tr class="text-left">
                <th class="px-4 py-3">연차연도</th>
                <th class="px-4 py-3">기간</th>
                <th class="px-4 py-3">부여일수</th>
                <th class="px-4 py-3">누계</th>
                <th class="px-4 py-3">비고</th>
              </tr>
            </thead>
            <tbody id="tbody-breakdown" class="divide-y divide-slate-200"></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- Guide Modal -->
  <div id="guide" class="fixed inset-0 hidden items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/30"></div>
    <div class="relative max-w-2xl w-full card p-6 md:p-8">
      <div class="flex items-start justify-between gap-6">
        <h3 class="text-2xl font-extrabold">계산 로직(간이)</h3>
        <button id="btn-close-guide" class="text-slate-600 hover:text-slate-900">닫기</button>
      </div>
      <ol class="mt-4 list-decimal pl-5 space-y-2 text-slate-700 text-sm leading-7">
        <li><b>1년 미만</b>: 입사일로부터 매 1개월 경과 시 1일(최대 11일) 부여.</li>
        <li><b>2년차 이후</b>: 매 근속연도 시작 시 15일 부여, 근속 3년 이상부터 2년마다 1일 가산(상한 25일). 발생 시점에 전량 부여(일할 비례 없음).</li>
        <li><b>만 1년만 근무 후 퇴직</b>: 대법원(2021.10.14.) 판결 및 고용부 해석 변경에 따라 최대 11일만 발생(다음날 근로자 지위가 없어 15일 미발생).</li>
        <li><b>법령 모드</b>: <u>2017‑05‑29 이전 입사자</u>는 종전 방식 적용 → <b>2년차는 15일에서 첫해 월차(최대 11일)를 차감</b>.</li>
        <li>출근율, 결근/휴직, 단시간근로자, 격일제 등 <b>특례는 미반영</b>. 실제 지급액/연차수당은 노무전문가/사규 기준을 확인하세요.</li>
      </ol>
    </div>
  </div>

  <!-- FAQ / Notes -->
  <section id="faq" class="mx-auto container px-5 pb-24">
    <div class="grid lg:grid-cols-2 gap-8">
      <div class="card p-6">
        <h4 class="text-xl font-bold">자주 묻는 질문</h4>
        <div class="mt-4 space-y-4 text-sm text-slate-700">
          <details class="card p-4">
            <summary class="cursor-pointer font-semibold">퇴직일은 어떻게 넣나요?</summary>
            <p class="mt-2">마지막 근무일 <b>다음날</b>을 입력합니다. 예) 12/31까지 근무 → 01/01 입력.</p>
          </details>
          <details class="card p-4">
            <summary class="cursor-pointer font-semibold">회계연도(1/1) 기준도 지원하나요?</summary>
            <p class="mt-2">UI는 포함되어 있으며, 계산 로직은 차기 업데이트 예정입니다. 현재는 <b>입사일 기준</b>을 권장합니다.</p>
          </details>
        </div>
      </div>
      
    </div>
  </section>

  <footer class="py-10 text-center text-slate-500 text-sm">
    <div class="mx-auto container px-5">© <span id=\"yy\"></span> 연차 휴가계산기 · Beta</div>
  </footer>

  <script>
    // ===== Utilities =====
    const fmt = (d)=> d.toISOString().slice(0,10);
    const toDate = (v)=> v? new Date(v + 'T00:00:00'): null;
    const addMonths = (d,n)=> { const x=new Date(d); const m=x.getMonth()+n; x.setMonth(m); const o=(m%12+12)%12; if(x.getMonth()!==o) x.setDate(0); return x; }
    const addYears = (d,n)=> addMonths(d, n*12);
    const addDays = (d,n)=>{ const x=new Date(d); x.setDate(x.getDate()+n); return x; }
    const clamp = (v,min,max)=> Math.max(min, Math.min(max,v));
    const daysBetween = (a,b)=> Math.max(0, Math.floor((b - a) / 86400000)); // [a,b)

    function firstYearMonthlyDays(start, end){
      const firstAnniv = addYears(start,1);
      const limitEnd = end < firstAnniv ? end : firstAnniv;
      let months = 0;
      for(let i=1;i<=11;i++){
        const mDate = addMonths(start,i);
        if(mDate <= limitEnd) months++; else break;
      }
      return clamp(months,0,11);
    }

    function statutoryAnnualAt(serviceYearsCompleted){
      if(serviceYearsCompleted < 1) return 0; // 1년 미만
      const extra = Math.max(0, Math.floor((serviceYearsCompleted - 1) / 2));
      return Math.min(15 + extra, 25);
    }

    function computeBreakdown(start, endExclusive, mode){
      const rows = [];
      const firstAnniv = addYears(start,1);
      // 1년차 (월 단위)
      const fyDays = firstYearMonthlyDays(start, endExclusive);
      if(fyDays>0){
        const fyEnd = endExclusive < firstAnniv ? endExclusive : firstAnniv;
        const fyEndInc = new Date(fyEnd.getTime()-86400000);
        rows.push({ label: '1년차(월 단위)', period: `${fmt(start)} ~ ${fmt(fyEndInc)}`, days: fyDays, note: '최대 11일' });
      }

      // 2년차부터 (입사일 기준 연도별) — 일할비례 제거, 발생 시점에 전량 부여
      let y = 1; // 근속연도 시작 카운트(1 → 2년차)
      while(true){
        const annivStart = addYears(start, y);
        if(annivStart >= endExclusive) break;
        let entitlement = statutoryAnnualAt(y);

        // 2017-05-29 이전 입사자(종전): 2년차는 15일에서 첫해 월차를 차감
        if(mode === 'pre20170530' && y === 1){
          entitlement = Math.max(15 - Math.min(fyDays, 11), 0);
        }

        if(entitlement > 0){
          const annivNext = addYears(start, y+1);
          const segEnd = annivNext < endExclusive ? annivNext : endExclusive;
          const segEndInc = new Date(segEnd.getTime()-86400000);
          const note = (mode === 'pre20170530' && y === 1)
            ? `2년차 보정: 15 - 1년차(${fyDays}) = ${entitlement}`
            : `기준 ${entitlement}일`;
          rows.push({ label: `${y+1}년차`, period: `${fmt(annivStart)} ~ ${fmt(segEndInc)}`, days: entitlement, note });
        }

        y++; if(y>60) break; // 안전장치
      }

      let acc = 0; rows.forEach(r=>{ acc += r.days; r.acc = +acc.toFixed(2); });
      return rows;
    }

    function render(rows){
      const tbody = document.getElementById('tbody-breakdown');
      tbody.innerHTML = '';
      let sum = 0, firstYear = 0, annual = 0;
      rows.forEach((r)=>{
        sum += r.days;
        if(r.label.startsWith('1년차')) firstYear += r.days; else annual += r.days;
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="px-4 py-3">${r.label}</td>
          <td class="px-4 py-3 text-slate-700">${r.period}</td>
          <td class="px-4 py-3 font-semibold">${r.days}일</td>
          <td class="px-4 py-3">${r.acc ?? ''}일</td>
          <td class="px-4 py-3 text-slate-500">${r.note ?? ''}</td>
        `;
        tbody.appendChild(tr);
      });
      document.getElementById('total-days').textContent = `${(+sum.toFixed(2))}일`;
      document.getElementById('first-year-days').textContent = `${firstYear}일`;
      document.getElementById('annual-days').textContent = `${(+annual.toFixed(2))}일`;
      document.getElementById('total-note').textContent = rows.length ? '소수점은 일할 반영 결과입니다.' : '';
      document.getElementById('result').classList.remove('hidden');
    }

    function toCSV(rows){
      const header = ['연차연도','기간','부여일수','누계','비고'];
      const body = rows.map(r=>[r.label,r.period,`${r.days}`,`${r.acc ?? ''}`,r.note??'']);
      const all = [header, ...body];
      return all.map(line => line.map(v => '"'+String(v).replaceAll('"','""')+'"').join(',')).join('\n');
    }

    // ===== Bindings =====
    const today = new Date();
    document.getElementById('yy').textContent = today.getFullYear();
    document.getElementById('demo-today').textContent = fmt(today);

    const $start = document.getElementById('start');
    const $end = document.getElementById('end');
    const $still = document.getElementById('still-employed');
    const $mode = document.getElementById('law-mode');

    $end.value = fmt(today);

    $still.addEventListener('change', ()=>{
      if($still.checked){ $end.value = fmt(new Date()); $end.disabled = true; }
      else { $end.disabled = false; }
    });

    document.getElementById('btn-fill-demo').addEventListener('click', ()=>{
      $start.value = '2024-08-29';
      $end.value = fmt(today);
      $still.checked = true; $end.disabled = true;
      location.hash = '#calc';
    });

    document.getElementById('btn-reset').addEventListener('click', ()=>{
      $start.value = '';
      $end.value = fmt(new Date());
      $still.checked = false; $end.disabled = false;
      document.getElementById('result').classList.add('hidden');
    });

    document.getElementById('btn-calc').addEventListener('click', ()=>{
      const s = toDate($start.value);
      let e = $still.checked ? new Date() : toDate($end.value);
      const mode = $mode.value;
      if(!s || !e){ alert('입사일과 계산일(퇴직일)을 모두 입력하세요.'); return; }
      if(e <= s){ alert('계산일(퇴직일)은 입사일 이후여야 합니다.'); return; }
      const dateMode = document.querySelector('input[name="date-mode"]:checked')?.value || 'asof';
      const endExclusive = dateMode === 'asof' ? addDays(e,1) : e;
      const rows = computeBreakdown(s, endExclusive, mode);
      render(rows);
      location.hash = '#result';
    });

    document.getElementById('btn-print').addEventListener('click', ()=> window.print());

    document.getElementById('btn-copy').addEventListener('click', ()=>{
      const tbody = document.getElementById('tbody-breakdown');
      const rows = [...tbody.querySelectorAll('tr')].map(tr => [...tr.children].map(td=>td.textContent.trim()).join('\t')).join('\n');
      const total = document.getElementById('total-days').textContent;
      const txt = `총 연차: ${total}\n` + rows;
      navigator.clipboard.writeText(txt).then(()=> alert('결과를 복사했습니다.'));
    });

    document.getElementById('btn-csv').addEventListener('click', ()=>{
      const s = toDate($start.value);
      let e = $still.checked ? new Date() : toDate($end.value);
      const mode = $mode.value;
      if(!s || !e){ alert('먼저 계산을 완료하세요.'); return; }
      const dateMode = document.querySelector('input[name="date-mode"]:checked')?.value || 'asof';
      const endExclusive = dateMode === 'asof' ? addDays(e,1) : e;
      const rows = computeBreakdown(s, endExclusive, mode);
      const csv = toCSV(rows);
      const blob = new Blob(["\ufeff" + csv], {type:'text/csv;charset=utf-8;'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = `연차휴가계산기_${fmt(new Date())}.csv`; a.click();
      setTimeout(()=> URL.revokeObjectURL(url), 4000);
    });

    // Modal
    const $guide = document.getElementById('guide');
    document.getElementById('btn-open-guide').addEventListener('click', ()=>{ $guide.classList.remove('hidden'); $guide.classList.add('flex'); });
    document.getElementById('btn-close-guide').addEventListener('click', ()=>{ $guide.classList.add('hidden'); $guide.classList.remove('flex'); });
  </script>
</body>
</html>
